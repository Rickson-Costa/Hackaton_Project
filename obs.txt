# ================================
# CONFIGURAÇÃO DO BANCO DE DADOS - SISTEMA FUNETEC
# ================================

# PROBLEMA: sqlite3.OperationalError: no such table: accounts_user
# SOLUÇÃO: Criar as migrações e aplicar ao banco de dados

# ============================================================================
# 1. PARAR O SERVIDOR (se estiver rodando)
# ============================================================================

# Pressione Ctrl+C no terminal onde o servidor está rodando

# ============================================================================
# 2. VERIFICAR SE ESTAMOS NO DIRETÓRIO CORRETO
# ============================================================================

cd C:\Users\rickson.costa\Documents\Pessoal\Sys\Hackaton_Project

# Deve ter o arquivo manage.py aqui
dir manage.py

# ============================================================================
# 3. CRIAR MIGRAÇÕES PARA TODOS OS APPS
# ============================================================================

# Criar migrações para o app accounts (usuários)
python manage.py makemigrations accounts

# Criar migrações para o app projetos
python manage.py makemigrations projetos

# Criar migrações para o app contratos
python manage.py makemigrations contratos

# Criar migrações para outros apps (se necessário)
python manage.py makemigrations core
python manage.py makemigrations dashboard
python manage.py makemigrations pagamentos
python manage.py makemigrations relatorios

# ============================================================================
# 4. APLICAR MIGRAÇÕES AO BANCO DE DADOS
# ============================================================================

# Aplicar migrações padrão do Django
python manage.py migrate

# ============================================================================
# 5. CRIAR SUPERUSUÁRIO
# ============================================================================

python manage.py createsuperuser

# Quando solicitado, digite:
# Username: admin
# Email: admin@funetec.org.br
# Password: admin123
# Password (again): admin123

# ============================================================================
# 6. INICIAR O SERVIDOR NOVAMENTE
# ============================================================================

python manage.py runserver

# ============================================================================
# 7. TESTAR O LOGIN
# ============================================================================

# Acesse: http://localhost:8000/accounts/login/
# Login: admin
# Senha: admin123

# ============================================================================
# 8. SE HOUVER ERRO NAS MIGRAÇÕES, EXECUTE INDIVIDUALMENTE
# ============================================================================

# Se der erro, execute um app de cada vez:

# Primeiro, apenas o accounts:
python manage.py makemigrations accounts --verbosity=2

# Se der erro, verifique o modelo User:
python manage.py check accounts

# Se necessário, aplique apenas migrações básicas primeiro:
python manage.py migrate auth
python manage.py migrate contenttypes
python manage.py migrate sessions
python manage.py migrate admin

# Depois tente novamente:
python manage.py makemigrations accounts
python manage.py migrate accounts

# ============================================================================
# 9. COMANDOS DE VERIFICAÇÃO
# ============================================================================

# Verificar se as tabelas foram criadas:
python manage.py dbshell
.tables
.quit

# Ou verificar com Django shell:
python manage.py shell
>>> from apps.accounts.models import User
>>> User.objects.count()
>>> exit()

# ============================================================================
# 10. SOLUÇÃO DE PROBLEMAS COMUNS
# ============================================================================

# Se der erro "no such table: django_migrations":
python manage.py migrate --run-syncdb

# Se der erro de campos no User model:
# Edite apps/accounts/models/user.py e remova campos problemáticos temporariamente

# Se der erro de imports circulares:
# Comente imports problemáticos nos __init__.py dos models

# ============================================================================
# 11. SEQUÊNCIA COMPLETA DE COMANDOS
# ============================================================================

# Execute esta sequência completa:
cd C:\Users\rickson.costa\Documents\Pessoal\Sys\Hackaton_Project
python manage.py check
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver

# ============================================================================
# 12. VERIFICAÇÃO FINAL
# ============================================================================

# Após criar o superusuário e iniciar o servidor:
# 1. Acesse: http://localhost:8000/accounts/login/
# 2. Login: admin / admin123
# 3. Deve redirecionar para: http://localhost:8000/dashboard/
# 4. Deve mostrar o dashboard do FUNETEC

# Se tudo funcionou, você verá:
# ✅ Página de login
# ✅ Login bem-sucedido
# ✅ Dashboard funcionando
# ✅ Menu de navegação
# ✅ Sistema operacional!

# ============================================================================
# 13. PRÓXIMOS PASSOS APÓS O LOGIN FUNCIONAR
# ============================================================================

# Teste estas URLs:
# http://localhost:8000/admin/           → Interface administrativa
# http://localhost:8000/projetos/       → Lista de projetos
# http://localhost:8000/contratos/      → Lista de contratos
# http://localhost:8000/accounts/profile/ → Perfil do usuário

# Parabéns! O sistema estará 100% funcional! 🎉